(function(n,t){var f=0,u=null,r=[],i=null;n.fn.split=function(e){function w(n){if(typeof n=="number")return n;if(typeof n=="string"){var t=n.match(/^([0-9]+)(px|%)$/);if(t){if(t[2]=="px")return+t[1];if(s.orientation=="vertical")return y*+t[1]/100;if(s.orientation=="horizontal")return p*+t[1]/100}}}var g=this.data("splitter"),c,v,s,b,k,l,h,o,a;if(g)return g;s=n.extend({limit:100,orientation:"horizontal",position:"50%",onDragStart:n.noop,onDragEnd:n.noop,onDrag:n.noop},e||{});k=this.children();s.orientation=="vertical"?(c=k.first().addClass("left_panel"),v=c.next().addClass("right_panel"),b="vsplitter"):s.orientation=="horizontal"&&(c=k.first().addClass("top_panel"),v=c.next().addClass("bottom_panel"),b="hsplitter");var y=this.width(),p=this.height(),d=f++;return this.addClass("splitter_panel"),l=n("<div/>").addClass(b).mouseenter(function(){u=d}).mouseleave(function(){u=null}).insertAfter(c),o=n.extend(this,{refresh:function(){var n=this.width(),t=this.height();(y!=n||p!=t)&&(y=this.width(),p=this.height(),o.position(h))},position:function(){return s.orientation=="vertical"?function(n,i){if(n===t)return h;h=w(n);var r=l.width()/2;return l.css("left",h-r),c.width(h-r),v.width(o.width()-h-r),i||o.find(".splitter_panel").trigger("splitter.resize"),o}:s.orientation=="horizontal"?function(n,i){if(n===t)return h;h=w(n);var r=l.height()/2;return l.css("top",h-r),c.height(h-r),v.height(o.height()-h-r),i||o.find(".splitter_panel").trigger("splitter.resize"),o}:n.noop}(),orientation:s.orientation,limit:s.limit,isActive:function(){return u===d},destroy:function(){var t,i;for(o.removeClass("splitter_panel"),l.unbind("mouseenter"),l.unbind("mouseleave"),s.orientation=="vertical"?(c.removeClass("left_panel"),v.removeClass("right_panel")):s.orientation=="horizontal"&&(c.removeClass("top_panel"),v.removeClass("bottom_panel")),o.unbind("splitter.resize"),o.find(".splitter_panel").trigger("splitter.resize"),r[d]=null,l.remove(),t=!1,i=r.length;i--;)if(r[i]!==null){t=!0;break}t||(n(document.documentElement).unbind(".splitter"),n(window).unbind("resize.splitter"),r=[])}}),o.bind("splitter.resize",function(){var n=o.position();o.orientation=="vertical"&&n>o.width()?n=o.width()-o.limit-1:o.orientation=="horizontal"&&n>o.height()&&(n=o.height()-o.limit-1);n<o.limit&&(n=o.limit+1);o.position(n,!0)}),s.orientation=="vertical"?a=a>y-s.limit?y-s.limit:w(s.position):s.orientation=="horizontal"&&(a=a>p-s.limit?p-s.limit:w(s.position)),a<s.limit&&(a=s.limit),o.position(a,!0),r.length==0&&(n(window).bind("resize.splitter",function(){n.each(r,function(n,t){t.refresh()})}),n(document.documentElement).bind("mousedown.splitter",function(t){if(u!==null){i=r[u];n('<div class="splitterMask"><\/div>').insertAfter(i);i.orientation=="horizontal"?n("body").css("cursor","row-resize"):i.orientation=="vertical"&&n("body").css("cursor","col-resize");s.onDragStart(t);return!1}}).bind("mouseup.splitter",function(t){n(".splitterMask").remove();i=null;n("body").css("cursor","auto");s.onDragEnd(t)}).bind("mousemove.splitter",function(n){var u,f,t,r;if(i!==null){if(u=i.limit,f=i.offset(),i.orientation=="vertical"){if(t=n.pageX-f.left,t<=i.limit?t=i.limit+1:t>=i.width()-u&&(t=i.width()-u-1),t>i.limit&&t<i.width()-u)return i.position(t,!0),i.find(".splitter_panel").trigger("splitter.resize"),!1}else if(i.orientation=="horizontal"&&(r=n.pageY-f.top,r<=i.limit?r=i.limit+1:r>=i.height()-u&&(r=i.height()-u-1),r>i.limit&&r<i.height()-u))return i.position(r,!0),i.trigger("splitter.resize"),!1;s.onDrag(n)}})),r.push(o),o.data("splitter",o),o}})(jQuery);